(()=>{var t={342:(t,e,a)=>{"use strict";!function(){var e,i,r,n=0,s=[];for(i=0;i<256;i++)s[i]=(i+256).toString(16).substr(1);function o(){var t=((!e||n+16>d.BUFFER_SIZE)&&(n=0,e=d.randomBytes(d.BUFFER_SIZE)),e.slice(n,n+=16));return t[6]=15&t[6]|64,t[8]=63&t[8]|128,t}function d(){var t=o();return s[t[0]]+s[t[1]]+s[t[2]]+s[t[3]]+"-"+s[t[4]]+s[t[5]]+"-"+s[t[6]]+s[t[7]]+"-"+s[t[8]]+s[t[9]]+"-"+s[t[10]]+s[t[11]]+s[t[12]]+s[t[13]]+s[t[14]]+s[t[15]]}d.BUFFER_SIZE=4096,d.bin=o,d.clearBuffer=function(){e=null,n=0},d.test=function(t){return"string"==typeof t&&/^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)},"undefined"!=typeof crypto?r=crypto:"undefined"!=typeof window&&void 0!==window.msCrypto&&(r=window.msCrypto),r=r||a(575),t.exports=d,d.randomBytes=function(){if(r){if(r.randomBytes)return r.randomBytes;if(r.getRandomValues)return"function"!=typeof Uint8Array.prototype.slice?function(t){var e=new Uint8Array(t);return r.getRandomValues(e),Array.from(e)}:function(t){var e=new Uint8Array(t);return r.getRandomValues(e),e}}return function(t){var e,a=[];for(e=0;e<t;e++)a.push(Math.floor(256*Math.random()));return a}}()}()},575:()=>{}},e={};function a(i){var r=e[i];if(void 0!==r)return r.exports;var n=e[i]={exports:{}};return t[i](n,n.exports,a),n.exports}(()=>{"use strict";var t,e=a(342),i=((t=i||{}).SECONDLY="SECONDLY",t.MINUTELY="MINUTELY",t.HOURLY="HOURLY",t.DAILY="DAILY",t.WEEKLY="WEEKLY",t.MONTHLY="MONTHLY",t.YEARLY="YEARLY",t),r=(t=>(t.SU="SU",t.MO="MO",t.TU="TU",t.WE="WE",t.TH="TH",t.FR="FR",t.SA="SA",t))(r||{});function n(t,e,a,i){if(t?.startsWith("/")&&(t=t.substr(1)),"string"==typeof e||e instanceof Date){let r=new Date(e),n=r.getUTCFullYear()+String(r.getUTCMonth()+1).padStart(2,"0")+r.getUTCDate().toString().padStart(2,"0");return t&&(n=r.getFullYear()+String(r.getMonth()+1).padStart(2,"0")+r.getDate().toString().padStart(2,"0")),a?n:t?(n+="T"+r.getHours().toString().padStart(2,"0")+r.getMinutes().toString().padStart(2,"0")+r.getSeconds().toString().padStart(2,"0"),n):(n+="T"+r.getUTCHours().toString().padStart(2,"0")+r.getUTCMinutes().toString().padStart(2,"0")+r.getUTCSeconds().toString().padStart(2,"0")+(i?"":"Z"),n)}if(p(e)){let r=t?g(e)&&!e.tz()?e.clone().tz(t):e:i||a&&g(e)&&e.tz()?e:e.utc();return r.format("YYYYMMDD")+(a?"":"T"+r.format("HHmmss")+(i||t?"":"Z"))}if(f(e)){let r=t?e.setZone(t):i||a&&"system"!==e.zone.type?e:e.setZone("utc");return r.toFormat("yyyyLLdd")+(a?"":"T"+r.toFormat("HHmmss")+(i||t?"":"Z"))}{let r=e;if(t)r="function"==typeof e.tz?e.tz(t):e;else if(!i){if("function"!=typeof e.utc)throw new Error("Unable to convert dayjs object to UTC value: UTC plugin is not available!");r=e.utc()}return r.format("YYYYMMDD")+(a?"":"T"+r.format("HHmmss")+(i||t?"":"Z"))}}function s(t,e,a,i){let r="",s=i?.floating||!1;return i?.timezone&&(r=";TZID="+i.timezone,s=!0),e+r+":"+n(t,a,!1,s)}function o(t,e){return String(t).replace(e?/[\\"]/g:/[\\;,]/g,(function(t){return"\\"+t})).replace(/(?:\r\n|\r|\n)/g,"\\n")}function d(t,e,a){if(Array.isArray(e))t.x=e.map((t=>{if(Array.isArray(t))return t;if("string"!=typeof t.key||"string"!=typeof t.value)throw new Error("Either key or value is not a string!");if("X-"!==t.key.substr(0,2))throw new Error("Key has to start with `X-`!");return[t.key,t.value]}));else if("object"==typeof e)t.x=Object.entries(e).map((([t,e])=>{if("string"!=typeof t||"string"!=typeof e)throw new Error("Either key or value is not a string!");if("X-"!==t.substr(0,2))throw new Error("Key has to start with `X-`!");return[t,e]}));else{if("string"!=typeof e||"string"!=typeof a)return t.x.map((t=>({key:t[0],value:t[1]})));if("X-"!==e.substr(0,2))throw new Error("Key has to start with `X-`!");t.x.push([e,a])}}function l(t){let e=t.x.map((([t,e])=>t.toUpperCase()+":"+o(e,!1))).join("\r\n");return e.length?e+"\r\n":""}function h(t,e){let a=null;if("string"==typeof e){let t=e.match(/^(.+) ?<([^>]+)>$/);t?a={name:t[1].trim(),email:t[2].trim()}:e.includes("@")&&(a={name:e.trim(),email:e.trim()})}else"object"==typeof e&&(a={name:e.name,email:e.email,mailto:e.mailto,sentBy:e.sentBy});if(!a&&"string"==typeof e)throw new Error("`"+t+"` isn't formated correctly. See https://sebbo2002.github.io/ical-generator/develop/reference/interfaces/ICalOrganizer.html");if(!a)throw new Error("`"+t+"` needs to be a valid formed string or an object. See https://sebbo2002.github.io/ical-generator/develop/reference/interfaces/ICalOrganizer.html");if(!a.name)throw new Error("`"+t+".name` is empty!");return a}function u(t,e){let a=Object.values(t),i=String(e).toUpperCase();if(!i||!a.includes(i))throw new Error(`Input must be one of the following: ${a.join(", ")}`);return i}function c(t,e){if(t instanceof Date&&isNaN(t.getTime())||"string"==typeof t&&isNaN(new Date(t).getTime()))throw new Error(`\`${e}\` has to be a valid date!`);if(t instanceof Date||"string"==typeof t||f(t)&&!0===t.isValid||(p(t)||function(t){return!("object"!=typeof t||null===t||t instanceof Date||p(t)||f(t))}(t))&&t.isValid())return t;throw new Error(`\`${e}\` has to be a valid date!`)}function m(t){return"string"==typeof t||t instanceof Date?new Date(t):f(t)?t.toJSDate():t.toDate()}function p(t){return null!=t&&null!=t._isAMomentObject}function g(t){return p(t)&&"tz"in t&&"function"==typeof t.tz}function f(t){return"object"==typeof t&&null!==t&&"toJSDate"in t&&"function"==typeof t.toJSDate}function y(t){return null!==t&&"object"==typeof t&&"between"in t&&"function"==typeof t.between&&"function"==typeof t.toString}function E(t){return t?"string"==typeof t?t:t.toJSON():null}function T(t){let e="";return t<0&&(e="-",t*=-1),e+="P",t>=86400&&(e+=Math.floor(t/86400)+"D",t%=86400),!t&&e.length>1||(e+="T",t>=3600&&(e+=Math.floor(t/3600)+"H",t%=3600),t>=60&&(e+=Math.floor(t/60)+"M",t%=60),t>0?e+=t+"S":e.length<=2&&(e+="0S")),e}var v,A,D,S,b,I=((A=I||{}).CHAIR="CHAIR",A.REQ="REQ-PARTICIPANT",A.OPT="OPT-PARTICIPANT",A.NON="NON-PARTICIPANT",A),w=((v=w||{}).ACCEPTED="ACCEPTED",v.TENTATIVE="TENTATIVE",v.DECLINED="DECLINED",v.DELEGATED="DELEGATED",v.NEEDSACTION="NEEDS-ACTION",v),R=(t=>(t.INDIVIDUAL="INDIVIDUAL",t.GROUP="GROUP",t.RESOURCE="RESOURCE",t.ROOM="ROOM",t.UNKNOWN="UNKNOWN",t))(R||{}),N=class t{data;parent;constructor(t,e){if(this.data={name:null,email:"",mailto:null,sentBy:null,status:null,role:"REQ-PARTICIPANT",rsvp:null,type:null,delegatedTo:null,delegatedFrom:null,x:[]},this.parent=e,!this.parent)throw new Error("`event` option required!");if(!t.email)throw new Error("No value for `email` in ICalAttendee given!");void 0!==t.name&&this.name(t.name),void 0!==t.email&&this.email(t.email),void 0!==t.mailto&&this.mailto(t.mailto),void 0!==t.sentBy&&this.sentBy(t.sentBy),void 0!==t.status&&this.status(t.status),void 0!==t.role&&this.role(t.role),void 0!==t.rsvp&&this.rsvp(t.rsvp),void 0!==t.type&&this.type(t.type),void 0!==t.delegatedTo&&this.delegatedTo(t.delegatedTo),void 0!==t.delegatedFrom&&this.delegatedFrom(t.delegatedFrom),t.delegatesTo&&this.delegatesTo(t.delegatesTo),t.delegatesFrom&&this.delegatesFrom(t.delegatesFrom),void 0!==t.x&&this.x(t.x)}name(t){return void 0===t?this.data.name:(this.data.name=t||null,this)}email(t){return t?(this.data.email=t,this):this.data.email}mailto(t){return void 0===t?this.data.mailto:(this.data.mailto=t||null,this)}sentBy(t){return t?(this.data.sentBy=t,this):this.data.sentBy}role(t){return void 0===t?this.data.role:(this.data.role=u(I,t),this)}rsvp(t){return void 0===t?this.data.rsvp:null===t?(this.data.rsvp=null,this):(this.data.rsvp=!!t,this)}status(t){return void 0===t?this.data.status:t?(this.data.status=u(w,t),this):(this.data.status=null,this)}type(t){return void 0===t?this.data.type:t?(this.data.type=u(R,t),this):(this.data.type=null,this)}delegatedTo(e){return void 0===e?this.data.delegatedTo:e?(this.data.delegatedTo="string"==typeof e?new t({email:e,...h("delegatedTo",e)},this.parent):e instanceof t?e:new t(e,this.parent),this.data.status="DELEGATED",this):(this.data.delegatedTo=null,"DELEGATED"===this.data.status&&(this.data.status=null),this)}delegatedFrom(e){return void 0===e?this.data.delegatedFrom:(this.data.delegatedFrom=e?"string"==typeof e?new t({email:e,...h("delegatedFrom",e)},this.parent):e instanceof t?e:new t(e,this.parent):null,this)}delegatesTo(e){let a=e instanceof t?e:this.parent.createAttendee(e);return this.delegatedTo(a),a.delegatedFrom(this),a}delegatesFrom(e){let a=e instanceof t?e:this.parent.createAttendee(e);return this.delegatedFrom(a),a.delegatedTo(this),a}x(t,e){if(void 0===t)return d(this.data);if("string"==typeof t&&"string"==typeof e)d(this.data,t,e);else{if("object"!=typeof t)throw new Error("Either key or value is not a string!");d(this.data,t)}return this}toJSON(){return Object.assign({},this.data,{delegatedTo:this.data.delegatedTo?.email()||null,delegatedFrom:this.data.delegatedFrom?.email()||null,x:this.x()})}toString(){let t="ATTENDEE";if(!this.data.email)throw new Error("No value for `email` in ICalAttendee given!");return t+=";ROLE="+this.data.role,this.data.type&&(t+=";CUTYPE="+this.data.type),this.data.status&&(t+=";PARTSTAT="+this.data.status),null!==this.data.rsvp&&(t+=";RSVP="+this.data.rsvp.toString().toUpperCase()),null!==this.data.sentBy&&(t+=';SENT-BY="mailto:'+this.data.sentBy+'"'),this.data.delegatedTo&&(t+=';DELEGATED-TO="'+this.data.delegatedTo.email()+'"'),this.data.delegatedFrom&&(t+=';DELEGATED-FROM="'+this.data.delegatedFrom.email()+'"'),this.data.name&&(t+=';CN="'+o(this.data.name,!0)+'"'),this.data.email&&this.data.mailto&&(t+=";EMAIL="+o(this.data.email,!1)),this.data.x.length&&(t+=";"+this.data.x.map((([t,e])=>t.toUpperCase()+"="+o(e,!1))).join(";")),t+=":MAILTO:"+o(this.data.mailto||this.data.email,!1)+"\r\n",t}},C=((D=C||{}).display="display",D.audio="audio",D.email="email",D),O={end:"END",start:"START"},U=class{data;event;constructor(t,e){if(this.data={type:"display",trigger:-600,relatesTo:null,repeat:null,interval:null,attach:null,description:null,summary:null,attendees:[],x:[]},this.event=e,!e)throw new Error("`event` option required!");void 0!==t.type&&this.type(t.type),"trigger"in t&&void 0!==t.trigger&&this.trigger(t.trigger),"triggerBefore"in t&&void 0!==t.triggerBefore&&this.triggerBefore(t.triggerBefore),"triggerAfter"in t&&void 0!==t.triggerAfter&&this.triggerAfter(t.triggerAfter),t.repeat&&this.repeat(t.repeat),void 0!==t.attach&&this.attach(t.attach),void 0!==t.description&&this.description(t.description),void 0!==t.summary&&this.summary(t.summary),void 0!==t.attendees&&this.attendees(t.attendees),void 0!==t.x&&this.x(t.x)}type(t){if(void 0===t)return this.data.type;if(!t||!Object.keys(C).includes(t))throw new Error("`type` is not correct, must be either `display` or `audio`!");return this.data.type=t,this}trigger(t){if(void 0===t&&"number"==typeof this.data.trigger)return-1*this.data.trigger;if(void 0===t)return this.data.trigger;if("number"==typeof t&&isFinite(t))this.data.trigger=-1*t;else{if(!t||"number"==typeof t)throw new Error("`trigger` is not correct, must be a finite number or a supported date!");this.data.trigger=c(t,"trigger")}return this}relatesTo(t){if(void 0===t)return this.data.relatesTo;if(!t)return this.data.relatesTo=null,this;if(!Object.values(O).includes(t))throw new Error("`relatesTo` is not correct, must be either `START` or `END`!");return this.data.relatesTo=t,this}triggerAfter(t){return void 0===t?this.data.trigger:this.trigger("number"==typeof t?-1*t:t)}triggerBefore(t){return void 0===t?this.trigger():this.trigger(t)}repeat(t){if(void 0===t)return this.data.repeat;if(!t)return this.data.repeat=null,this;if("object"!=typeof t)throw new Error("`repeat` is not correct, must be an object!");if("number"!=typeof t.times||!isFinite(t.times))throw new Error("`repeat.times` is not correct, must be numeric!");if("number"!=typeof t.interval||!isFinite(t.interval))throw new Error("`repeat.interval` is not correct, must be numeric!");return this.data.repeat=t,this}attach(t){if(void 0===t)return this.data.attach;if(!t)return this.data.attach=null,this;let e=null;if("string"==typeof t)e={uri:t,mime:null};else{if("object"!=typeof t)throw new Error("`attachment` needs to be a valid formed string or an object. See https://sebbo2002.github.io/ical-generator/develop/reference/classes/ICalAlarm.html#attach");e={uri:t.uri,mime:t.mime||null}}if(!e.uri)throw new Error("`attach.uri` is empty!");return this.data.attach={uri:e.uri,mime:e.mime},this}description(t){return void 0===t?this.data.description:t?(this.data.description=t,this):(this.data.description=null,this)}summary(t){return void 0===t?this.data.summary:t?(this.data.summary=t,this):(this.data.summary=null,this)}createAttendee(t){if(t instanceof N)return this.data.attendees.push(t),t;"string"==typeof t&&(t={email:t,...h("data",t)});let e=new N(t,this);return this.data.attendees.push(e),e}attendees(t){return t?(t.forEach((t=>this.createAttendee(t))),this):this.data.attendees}x(t,e){if(void 0===t)return d(this.data);if("string"==typeof t&&"string"==typeof e)d(this.data,t,e);else{if("object"!=typeof t)throw new Error("Either key or value is not a string!");d(this.data,t)}return this}toJSON(){let t=this.trigger();return Object.assign({},this.data,{trigger:"number"==typeof t?t:E(t),x:this.x()})}toString(){let t="BEGIN:VALARM\r\n";if(t+="ACTION:"+this.data.type.toUpperCase()+"\r\n","number"==typeof this.data.trigger&&null===this.data.relatesTo?this.data.trigger>0?t+="TRIGGER;RELATED=END:"+T(this.data.trigger)+"\r\n":t+="TRIGGER:"+T(this.data.trigger)+"\r\n":"number"==typeof this.data.trigger?t+="TRIGGER;RELATED="+this.data.relatesTo?.toUpperCase()+":"+T(this.data.trigger)+"\r\n":t+="TRIGGER;VALUE=DATE-TIME:"+n(this.event.timezone(),this.data.trigger)+"\r\n",this.data.repeat){if(!this.data.repeat.times)throw new Error("No value for `repeat.times` in ICalAlarm given, but required for `interval`!");if(!this.data.repeat.interval)throw new Error("No value for `repeat.interval` in ICalAlarm given, but required for `repeat`!");t+="REPEAT:"+this.data.repeat.times+"\r\n",t+="DURATION:"+T(this.data.repeat.interval)+"\r\n"}return"audio"===this.data.type&&this.data.attach&&this.data.attach.mime?t+="ATTACH;FMTTYPE="+o(this.data.attach.mime,!1)+":"+o(this.data.attach.uri,!1)+"\r\n":"audio"===this.data.type&&this.data.attach?t+="ATTACH;VALUE=URI:"+o(this.data.attach.uri,!1)+"\r\n":"audio"===this.data.type&&(t+="ATTACH;VALUE=URI:Basso\r\n"),"audio"!==this.data.type&&this.data.description?t+="DESCRIPTION:"+o(this.data.description,!1)+"\r\n":"audio"!==this.data.type&&(t+="DESCRIPTION:"+o(this.event.summary(),!1)+"\r\n"),"email"===this.data.type&&this.data.summary?t+="SUMMARY:"+o(this.data.summary,!1)+"\r\n":"email"===this.data.type&&(t+="SUMMARY:"+o(this.event.summary(),!1)+"\r\n"),"email"===this.data.type&&this.data.attendees.forEach((e=>{t+=e.toString()})),t+=l(this.data),t+="END:VALARM\r\n",t}},L=class{data;constructor(t){if(this.data={name:""},!t.name)throw new Error("No value for `name` in ICalCategory given!");this.name(t.name)}name(t){return void 0===t?this.data.name:(this.data.name=t,this)}toJSON(){return Object.assign({},this.data)}toString(){return o(this.data.name,!1)}},M=(t=>(t.CONFIRMED="CONFIRMED",t.TENTATIVE="TENTATIVE",t.CANCELLED="CANCELLED",t))(M||{}),z=(t=>(t.FREE="FREE",t.TENTATIVE="TENTATIVE",t.BUSY="BUSY",t.OOF="OOF",t))(z||{}),x=((S=x||{}).TRANSPARENT="TRANSPARENT",S.OPAQUE="OPAQUE",S),P=(t=>(t.PUBLIC="PUBLIC",t.PRIVATE="PRIVATE",t.CONFIDENTIAL="CONFIDENTIAL",t))(P||{}),F=class{data;calendar;constructor(t,a){if(this.data={id:e(),sequence:0,start:new Date,end:null,recurrenceId:null,timezone:null,stamp:new Date,allDay:!1,floating:!1,repeating:null,summary:"",location:null,description:null,organizer:null,attendees:[],alarms:[],categories:[],status:null,busystatus:null,priority:null,url:null,attachments:[],transparency:null,created:null,lastModified:null,class:null,x:[]},this.calendar=a,!a)throw new Error("`calendar` option required!");t.id&&this.id(t.id),void 0!==t.sequence&&this.sequence(t.sequence),t.start&&this.start(t.start),void 0!==t.end&&this.end(t.end),void 0!==t.recurrenceId&&this.recurrenceId(t.recurrenceId),void 0!==t.timezone&&this.timezone(t.timezone),void 0!==t.stamp&&this.stamp(t.stamp),void 0!==t.allDay&&this.allDay(t.allDay),void 0!==t.floating&&this.floating(t.floating),void 0!==t.repeating&&this.repeating(t.repeating),void 0!==t.summary&&this.summary(t.summary),void 0!==t.location&&this.location(t.location),void 0!==t.description&&this.description(t.description),void 0!==t.organizer&&this.organizer(t.organizer),void 0!==t.attendees&&this.attendees(t.attendees),void 0!==t.alarms&&this.alarms(t.alarms),void 0!==t.categories&&this.categories(t.categories),void 0!==t.status&&this.status(t.status),void 0!==t.busystatus&&this.busystatus(t.busystatus),void 0!==t.priority&&this.priority(t.priority),void 0!==t.url&&this.url(t.url),void 0!==t.attachments&&this.attachments(t.attachments),void 0!==t.transparency&&this.transparency(t.transparency),void 0!==t.created&&this.created(t.created),void 0!==t.lastModified&&this.lastModified(t.lastModified),void 0!==t.class&&this.class(t.class),void 0!==t.x&&this.x(t.x)}id(t){return void 0===t?this.data.id:(this.data.id=String(t),this)}uid(t){return void 0===t?this.id():this.id(t)}sequence(t){if(void 0===t)return this.data.sequence;let e=parseInt(String(t),10);if(isNaN(e))throw new Error("`sequence` must be a number!");return this.data.sequence=t,this}start(t){return void 0===t?(this.swapStartAndEndIfRequired(),this.data.start):(this.data.start=c(t,"start"),this)}end(t){return void 0===t?(this.swapStartAndEndIfRequired(),this.data.end):null===t?(this.data.end=null,this):(this.data.end=c(t,"end"),this)}swapStartAndEndIfRequired(){if(this.data.start&&this.data.end&&m(this.data.start).getTime()>m(this.data.end).getTime()){let t=this.data.start;this.data.start=this.data.end,this.data.end=t}}recurrenceId(t){return void 0===t?this.data.recurrenceId:null===t?(this.data.recurrenceId=null,this):(this.data.recurrenceId=c(t,"recurrenceId"),this)}timezone(t){return void 0===t&&null!==this.data.timezone?this.data.timezone:void 0===t?this.calendar.timezone():(this.data.timezone=t&&"UTC"!==t?t.toString():null,this.data.timezone&&(this.data.floating=!1),this)}stamp(t){return void 0===t?this.data.stamp:(this.data.stamp=c(t,"stamp"),this)}timestamp(t){return void 0===t?this.stamp():this.stamp(t)}allDay(t){return void 0===t?this.data.allDay:(this.data.allDay=!!t,this)}floating(t){return void 0===t?this.data.floating:(this.data.floating=!!t,this.data.floating&&(this.data.timezone=null),this)}repeating(t){if(void 0===t)return this.data.repeating;if(!t)return this.data.repeating=null,this;if(y(t)||"string"==typeof t)return this.data.repeating=t,this;if(this.data.repeating={freq:u(i,t.freq)},t.count){if(!isFinite(t.count))throw new Error("`repeating.count` must be a finite number!");this.data.repeating.count=t.count}if(t.interval){if(!isFinite(t.interval))throw new Error("`repeating.interval` must be a finite number!");this.data.repeating.interval=t.interval}if(void 0!==t.until&&(this.data.repeating.until=c(t.until,"repeating.until")),t.byDay){let e=Array.isArray(t.byDay)?t.byDay:[t.byDay];this.data.repeating.byDay=e.map((t=>u(r,t)))}if(t.byMonth){let e=Array.isArray(t.byMonth)?t.byMonth:[t.byMonth];this.data.repeating.byMonth=e.map((t=>{if("number"!=typeof t||t<1||t>12)throw new Error("`repeating.byMonth` contains invalid value `"+t+"`!");return t}))}if(t.byMonthDay){let e=Array.isArray(t.byMonthDay)?t.byMonthDay:[t.byMonthDay];this.data.repeating.byMonthDay=e.map((t=>{if("number"!=typeof t||t<-31||t>31||0===t)throw new Error("`repeating.byMonthDay` contains invalid value `"+t+"`!");return t}))}if(t.bySetPos){if(!this.data.repeating.byDay)throw"`repeating.bySetPos` must be used along with `repeating.byDay`!";let e=Array.isArray(t.bySetPos)?t.bySetPos:[t.bySetPos];this.data.repeating.bySetPos=e.map((t=>{if("number"!=typeof t||t<-366||t>366||0===t)throw"`repeating.bySetPos` contains invalid value `"+t+"`!";return t}))}if(t.exclude){let e=Array.isArray(t.exclude)?t.exclude:[t.exclude];this.data.repeating.exclude=e.map(((t,e)=>c(t,`repeating.exclude[${e}]`)))}return t.startOfWeek&&(this.data.repeating.startOfWeek=u(r,t.startOfWeek)),this}summary(t){return void 0===t?this.data.summary:(this.data.summary=t?String(t):"",this)}location(t){if(void 0===t)return this.data.location;if("string"==typeof t)return this.data.location={title:t},this;if(t&&("title"in t&&!t.title||t?.geo&&("number"!=typeof t.geo.lat||!isFinite(t.geo.lat)||"number"!=typeof t.geo.lon||!isFinite(t.geo.lon))||!("title"in t)&&!t?.geo))throw new Error("`location` isn't formatted correctly. See https://sebbo2002.github.io/ical-generator/develop/reference/classes/ICalEvent.html#location");return this.data.location=t||null,this}description(t){return void 0===t?this.data.description:null===t?(this.data.description=null,this):(this.data.description="string"==typeof t?{plain:t}:t,this)}organizer(t){return void 0===t?this.data.organizer:null===t?(this.data.organizer=null,this):(this.data.organizer=h("organizer",t),this)}createAttendee(t){if(t instanceof N)return this.data.attendees.push(t),t;"string"==typeof t&&(t={email:t,...h("data",t)});let e=new N(t,this);return this.data.attendees.push(e),e}attendees(t){return t?(t.forEach((t=>this.createAttendee(t))),this):this.data.attendees}createAlarm(t){let e=t instanceof U?t:new U(t,this);return this.data.alarms.push(e),e}alarms(t){return t?(t.forEach((t=>this.createAlarm(t))),this):this.data.alarms}createCategory(t){let e=t instanceof L?t:new L(t);return this.data.categories.push(e),e}categories(t){return t?(t.forEach((t=>this.createCategory(t))),this):this.data.categories}status(t){return void 0===t?this.data.status:null===t?(this.data.status=null,this):(this.data.status=u(M,t),this)}busystatus(t){return void 0===t?this.data.busystatus:null===t?(this.data.busystatus=null,this):(this.data.busystatus=u(z,t),this)}priority(t){if(void 0===t)return this.data.priority;if(null===t)return this.data.priority=null,this;if(t<0||t>9)throw new Error("`priority` is invalid, musst be 0 ≤ priority ≤ 9.");return this.data.priority=Math.round(t),this}url(t){return void 0===t?this.data.url:(this.data.url=t?String(t):null,this)}createAttachment(t){return this.data.attachments.push(t),this}attachments(t){return t?(t.forEach((t=>this.createAttachment(t))),this):this.data.attachments}transparency(t){return void 0===t?this.data.transparency:t?(this.data.transparency=u(x,t),this):(this.data.transparency=null,this)}created(t){return void 0===t?this.data.created:null===t?(this.data.created=null,this):(this.data.created=c(t,"created"),this)}lastModified(t){return void 0===t?this.data.lastModified:null===t?(this.data.lastModified=null,this):(this.data.lastModified=c(t,"lastModified"),this)}class(t){return void 0===t?this.data.class:null===t?(this.data.class=null,this):(this.data.class=u(P,t),this)}x(t,e){return void 0===t?d(this.data):("string"==typeof t&&"string"==typeof e&&d(this.data,t,e),"object"==typeof t&&d(this.data,t),this)}toJSON(){let t=null;return y(this.data.repeating)||"string"==typeof this.data.repeating?t=this.data.repeating.toString():this.data.repeating&&(t=Object.assign({},this.data.repeating,{until:E(this.data.repeating.until)||void 0,exclude:this.data.repeating.exclude?.map((t=>E(t)))})),this.swapStartAndEndIfRequired(),Object.assign({},this.data,{start:E(this.data.start)||null,end:E(this.data.end)||null,recurrenceId:E(this.data.recurrenceId)||null,stamp:E(this.data.stamp)||null,created:E(this.data.created)||null,lastModified:E(this.data.lastModified)||null,repeating:t,x:this.x()})}toString(){let t="";if(t+="BEGIN:VEVENT\r\n",t+="UID:"+this.data.id+"\r\n",t+="SEQUENCE:"+this.data.sequence+"\r\n",this.swapStartAndEndIfRequired(),t+="DTSTAMP:"+n(this.calendar.timezone(),this.data.stamp)+"\r\n",this.data.allDay?(t+="DTSTART;VALUE=DATE:"+n(this.timezone(),this.data.start,!0)+"\r\n",this.data.end&&(t+="DTEND;VALUE=DATE:"+n(this.timezone(),this.data.end,!0)+"\r\n"),t+="X-MICROSOFT-CDO-ALLDAYEVENT:TRUE\r\n",t+="X-MICROSOFT-MSNCALENDAR-ALLDAYEVENT:TRUE\r\n"):(t+=s(this.timezone(),"DTSTART",this.data.start,this.data)+"\r\n",this.data.end&&(t+=s(this.timezone(),"DTEND",this.data.end,this.data)+"\r\n")),y(this.data.repeating)||"string"==typeof this.data.repeating){let e=this.data.repeating.toString().replace(/\r\n/g,"\n").split("\n").filter((t=>t&&!t.startsWith("DTSTART:"))).join("\r\n");!e.includes("\r\n")&&!e.startsWith("RRULE:")&&(e="RRULE:"+e),t+=e.trim()+"\r\n"}else this.data.repeating&&(t+="RRULE:FREQ="+this.data.repeating.freq,this.data.repeating.count&&(t+=";COUNT="+this.data.repeating.count),this.data.repeating.interval&&(t+=";INTERVAL="+this.data.repeating.interval),this.data.repeating.until&&(t+=";UNTIL="+n(this.calendar.timezone(),this.data.repeating.until,!1,this.floating())),this.data.repeating.byDay&&(t+=";BYDAY="+this.data.repeating.byDay.join(",")),this.data.repeating.byMonth&&(t+=";BYMONTH="+this.data.repeating.byMonth.join(",")),this.data.repeating.byMonthDay&&(t+=";BYMONTHDAY="+this.data.repeating.byMonthDay.join(",")),this.data.repeating.bySetPos&&(t+=";BYSETPOS="+this.data.repeating.bySetPos.join(",")),this.data.repeating.startOfWeek&&(t+=";WKST="+this.data.repeating.startOfWeek),t+="\r\n",this.data.repeating.exclude&&(this.data.allDay?t+="EXDATE;VALUE=DATE:"+this.data.repeating.exclude.map((t=>n(this.calendar.timezone(),t,!0))).join(",")+"\r\n":(t+="EXDATE",this.timezone()?t+=";TZID="+this.timezone()+":"+this.data.repeating.exclude.map((t=>n(this.timezone(),t,!1,!0))).join(",")+"\r\n":t+=":"+this.data.repeating.exclude.map((t=>n(this.timezone(),t,!1,this.floating()))).join(",")+"\r\n")));return this.data.recurrenceId&&(t+=s(this.timezone(),"RECURRENCE-ID",this.data.recurrenceId,this.data)+"\r\n"),t+="SUMMARY:"+o(this.data.summary,!1)+"\r\n",this.data.transparency&&(t+="TRANSP:"+o(this.data.transparency,!1)+"\r\n"),this.data.location&&"title"in this.data.location&&this.data.location.title&&(t+="LOCATION:"+o(this.data.location.title+(this.data.location.address?"\n"+this.data.location.address:""),!1)+"\r\n",this.data.location.radius&&this.data.location.geo&&(t+="X-APPLE-STRUCTURED-LOCATION;VALUE=URI;"+(this.data.location.address?"X-ADDRESS="+o(this.data.location.address,!1)+";":"")+"X-APPLE-RADIUS="+o(this.data.location.radius,!1)+";X-TITLE="+o(this.data.location.title,!1)+":geo:"+o(this.data.location.geo?.lat,!1)+","+o(this.data.location.geo?.lon,!1)+"\r\n")),this.data.location?.geo?.lat&&this.data.location.geo.lon&&(t+="GEO:"+o(this.data.location.geo.lat,!1)+";"+o(this.data.location.geo.lon,!1)+"\r\n"),this.data.description&&(t+="DESCRIPTION:"+o(this.data.description.plain,!1)+"\r\n",this.data.description.html&&(t+="X-ALT-DESC;FMTTYPE=text/html:"+o(this.data.description.html,!1)+"\r\n")),this.data.organizer&&(t+='ORGANIZER;CN="'+o(this.data.organizer.name,!0)+'"',this.data.organizer.sentBy&&(t+=';SENT-BY="mailto:'+o(this.data.organizer.sentBy,!0)+'"'),this.data.organizer.email&&this.data.organizer.mailto&&(t+=";EMAIL="+o(this.data.organizer.email,!1)),t+=":",this.data.organizer.email&&(t+="mailto:"+o(this.data.organizer.mailto||this.data.organizer.email,!1)),t+="\r\n"),this.data.attendees.forEach((function(e){t+=e.toString()})),this.data.alarms.forEach((function(e){t+=e.toString()})),this.data.categories.length>0&&(t+="CATEGORIES:"+this.data.categories.map((t=>t.toString())).join()+"\r\n"),this.data.url&&(t+="URL;VALUE=URI:"+o(this.data.url,!1)+"\r\n"),this.data.attachments.length>0&&this.data.attachments.forEach((e=>{t+="ATTACH:"+o(e,!1)+"\r\n"})),this.data.status&&(t+="STATUS:"+this.data.status.toUpperCase()+"\r\n"),this.data.busystatus&&(t+="X-MICROSOFT-CDO-BUSYSTATUS:"+this.data.busystatus.toUpperCase()+"\r\n"),null!==this.data.priority&&(t+="PRIORITY:"+this.data.priority+"\r\n"),t+=l(this.data),this.data.created&&(t+="CREATED:"+n(this.calendar.timezone(),this.data.created)+"\r\n"),this.data.lastModified&&(t+="LAST-MODIFIED:"+n(this.calendar.timezone(),this.data.lastModified)+"\r\n"),this.data.class&&(t+="CLASS:"+this.data.class.toUpperCase()+"\r\n"),t+="END:VEVENT\r\n",t}},B=((b=B||{}).PUBLISH="PUBLISH",b.REQUEST="REQUEST",b.REPLY="REPLY",b.ADD="ADD",b.CANCEL="CANCEL",b.REFRESH="REFRESH",b.COUNTER="COUNTER",b.DECLINECOUNTER="DECLINECOUNTER",b),Y=class{data;constructor(t={}){this.data={prodId:"//sebbo.net//ical-generator//EN",method:null,name:null,description:null,timezone:null,source:null,url:null,scale:null,ttl:null,events:[],x:[]},void 0!==t.prodId&&this.prodId(t.prodId),void 0!==t.method&&this.method(t.method),void 0!==t.name&&this.name(t.name),void 0!==t.description&&this.description(t.description),void 0!==t.timezone&&this.timezone(t.timezone),void 0!==t.source&&this.source(t.source),void 0!==t.url&&this.url(t.url),void 0!==t.scale&&this.scale(t.scale),void 0!==t.ttl&&this.ttl(t.ttl),void 0!==t.events&&this.events(t.events),void 0!==t.x&&this.x(t.x)}prodId(t){if(!t)return this.data.prodId;if("string"==typeof t)return this.data.prodId=t,this;if("object"!=typeof t)throw new Error("`prodid` needs to be a string or an object!");if(!t.company)throw new Error("`prodid.company` is a mandatory item!");if(!t.product)throw new Error("`prodid.product` is a mandatory item!");let e=(t.language||"EN").toUpperCase();return this.data.prodId="//"+t.company+"//"+t.product+"//"+e,this}method(t){return void 0===t?this.data.method:t?(this.data.method=u(B,t),this):(this.data.method=null,this)}name(t){return void 0===t?this.data.name:(this.data.name=t?String(t):null,this)}description(t){return void 0===t?this.data.description:(this.data.description=t?String(t):null,this)}timezone(t){return void 0===t?this.data.timezone?.name||null:(this.data.timezone="UTC"===t?null:"string"==typeof t?{name:t}:null===t?null:t,this)}source(t){return void 0===t?this.data.source:(this.data.source=t||null,this)}url(t){return void 0===t?this.data.url:(this.data.url=t||null,this)}scale(t){return void 0===t?this.data.scale:(this.data.scale=null===t?null:t.toUpperCase(),this)}ttl(t){return void 0===t?this.data.ttl:(null!==(e=t)&&"object"==typeof e&&"asSeconds"in e&&"function"==typeof e.asSeconds?this.data.ttl=t.asSeconds():this.data.ttl=t&&t>0?t:null,this);var e}createEvent(t){let e=t instanceof F?t:new F(t,this);return this.data.events.push(e),e}events(t){return t?(t.forEach((t=>this.createEvent(t))),this):this.data.events}clear(){return this.data.events=[],this}x(t,e){if(void 0===t)return d(this.data);if("string"==typeof t&&"string"==typeof e)d(this.data,t,e);else{if("object"!=typeof t)throw new Error("Either key or value is not a string!");d(this.data,t)}return this}toJSON(){return Object.assign({},this.data,{timezone:this.timezone(),events:this.data.events.map((t=>t.toJSON())),x:this.x()})}length(){return this.data.events.length}toString(){let t="";return t="BEGIN:VCALENDAR\r\nVERSION:2.0\r\n",t+="PRODID:-"+this.data.prodId+"\r\n",this.data.url&&(t+="URL:"+this.data.url+"\r\n"),this.data.source&&(t+="SOURCE;VALUE=URI:"+this.data.source+"\r\n"),this.data.scale&&(t+="CALSCALE:"+this.data.scale+"\r\n"),this.data.method&&(t+="METHOD:"+this.data.method+"\r\n"),this.data.name&&(t+="NAME:"+this.data.name+"\r\n",t+="X-WR-CALNAME:"+this.data.name+"\r\n"),this.data.description&&(t+="X-WR-CALDESC:"+this.data.description+"\r\n"),this.data.timezone?.generator&&[...new Set([this.timezone(),...this.data.events.map((t=>t.timezone()))])].filter((t=>null!==t&&!t.startsWith("/"))).forEach((e=>{if(!this.data.timezone?.generator)return;let a=this.data.timezone.generator(e);a&&(t+=a.replace(/\r\n/g,"\n").replace(/\n/g,"\r\n").trim()+"\r\n")})),this.data.timezone?.name&&(t+="TIMEZONE-ID:"+this.data.timezone.name+"\r\n",t+="X-WR-TIMEZONE:"+this.data.timezone.name+"\r\n"),this.data.ttl&&(t+="REFRESH-INTERVAL;VALUE=DURATION:"+T(this.data.ttl)+"\r\n",t+="X-PUBLISHED-TTL:"+T(this.data.ttl)+"\r\n"),this.data.events.forEach((e=>t+=e.toString())),t+=l(this.data),t+="END:VCALENDAR",t.split("\r\n").map((function(t){let e="",a=0;for(let i=0;i<t.length;i++){let r=t.charAt(i);r>="\ud800"&&r<="\udbff"&&(r+=t.charAt(++i));let n=(new TextEncoder).encode(r).length;a+=n,a>74&&(e+="\r\n ",a=n),e+=r}return e})).join("\r\n")}};function j(t){return/\d{4}\s*[A-Z]\d{2}\s*([A-Z]\w*)/gm.exec(t)[1]}function V(t){return/\d{4}\s*([A-Z]\d{2})\s*[A-Z]\w*/gm.exec(t)[1]}function H(t){return/(\d{4})\s*[A-Z]\d{2}\s*[A-Z]\w*/gm.exec(t)[1]}function q(t){return t.match(/(?:[A-Z]\w.*\-.*)\s*(?:.*)\s*(?:.*)\s*(?:\d{2}\/\d{2}\/\d{4}\s*\-\s*\d{2}\/\d{2}\/\d{4})/gm)}function Z(t){const[e,a]=t.split("-");return{code:e.trim(),name:a.trim()}}const W={Mo:1,Tu:2,We:3,Th:4,Fr:5,Sa:6,Su:0};function G(t,e){const a=e.match(/(\d+):(\d+)(AM|PM)/);let i=parseInt(a[1],10);const r=parseInt(a[2],10),n=a[3];return"PM"===n&&12!==i?i+=12:"AM"===n&&12===i&&(i=0),t.setHours(i,r,0,0),t}function X(t,e){const a=t.getDay(),i=W[e.day],r=Math.abs(i-a);return t.setDate(t.getDate()+r),G(t,e.startTime)}function k(t,e){const a=t.getDay(),i=W[e.day]-a;return t.setDate(t.getDate()+i),G(t,e.endTime)}function $(t){return/([A-Z]\w.*\-.*)\s*(?:.*)\s*(?:.*)\s*(?:\d{2}\/\d{2}\/\d{4}\s*\-\s*\d{2}\/\d{2}\/\d{4})/gm.exec(t)[1]}function J(t){const e=t.match(/^(\w{2})\s+(\d{1,2}:\d{2}[AP]M)\s*-\s*(\d{1,2}:\d{2}[AP]M)$/);if(!e)return null;const[,a,i,r]=e;return{day:a,startTime:i,endTime:r}}function K(t){const e=t.match(/^\s*(\d{2}\/\d{2}\/\d{4})\s*-\s*(\d{2}\/\d{2}\/\d{4})\s*$/);if(!e)return null;const[,a,i]=e;function r(t){const[e,a,i]=t.split("/").map(Number);return new Date(i,e-1,a)}return{start:r(a),end:r(i)}}function Q(t){return/(?:[A-Z]\w.*\-.*)\s*(.*)\s*(?:.*)\s*(?:\d{2}\/\d{2}\/\d{4}\s*\-\s*\d{2}\/\d{2}\/\d{4})/gm.exec(t)[1]}function _(t){const e=t.match(/^(.*?)\s*\((.*?)\)\s*(.*)$/);if(!e)return null;const[,a,i,r]=e;return{address:a.trim(),building:i.trim(),room:r.trim()}}function tt(t){return/(?:[A-Z]\w.*\-.*)\s*(?:.*)\s*(.*)\s*(?:\d{2}\/\d{2}\/\d{4}\s*\-\s*\d{2}\/\d{2}\/\d{4})/gm.exec(t)[1]}function et(t){return/(?:[A-Z]\w.*\-.*)\s*(?:.*)\s*(?:.*)\s*(\d{2}\/\d{2}\/\d{4}\s*\-\s*\d{2}\/\d{2}\/\d{4})/gm.exec(t)[1]}function at(t){const e=t=>t.toString().padStart(2,"0");return t.getFullYear().toString()+e(t.getMonth()+1)+e(t.getDate())+"T"+e(t.getHours())+e(t.getMinutes())+e(t.getSeconds())}var it="calendar.ics";function rt(t){const e=(t+="#").match(/^\d{4}[\s\S]*?(?=^\d{4}|#)/gm),a=[];if(e)for(let t of e){const e=q(t),i=[];console.log("heree");for(let t of e){const e={dayNTime:J($(t)),location:_(Q(t)),instructor:tt(t),startEndDate:K(et(t))};e.actualStartDate=X(structuredClone(e).startEndDate.start,e.dayNTime),e.actualEndDate=k(structuredClone(e).startEndDate.start,e.dayNTime),i.push(e)}const r={componentType:j(t),component:t,section:V(t),classNumber:H(t),classes:i};a.push(r)}return a}function nt(){const t=[];let e;const a=document.getElementById("ptifrmtgtframe");if(a){const i=a.contentDocument||a.contentWindow.document;if(i){i.querySelectorAll(".PSGROUPBOXWBO").forEach((e=>{t.push(e.innerText.trim())}));const a=i.querySelectorAll("span.PABOLDTEXT");e=Array.from(a).map((t=>t.textContent)),console.log("Scraped data from iframe:",t)}else console.log("Iframe document is not accessible.")}else console.log("Iframe not found.");return{meta:e,data:t}}function st(){let t;const e=document.getElementById("ptifrmtgtframe");if(e){const a=e.contentDocument||e.contentWindow.document;if(a){const e=a.querySelectorAll("span.PABOLDTEXT");t=Array.from(e).map((t=>t.textContent)),console.log("Scraped data from iframe:",t)}else console.log("Iframe document is not accessible.")}else console.log("Iframe not found.");return t}document.addEventListener("DOMContentLoaded",(async()=>{let[t]=await chrome.tabs.query({active:!0,currentWindow:!0}),e=await chrome.scripting.executeScript({target:{tabId:t.id},func:st});if(void 0===e[0].result)return;let a=e[0].result[1].split("|").slice(0,2)[0].trim().split(" ").join("-");console.log(a),it=a+".ics",document.getElementById("file-name").value=it})),document.getElementById("scrape-btn").addEventListener("click",(async()=>{let[t]=await chrome.tabs.query({active:!0,currentWindow:!0}),e=await chrome.scripting.executeScript({target:{tabId:t.id},func:nt});e[0].result.meta[1],console.log(e[0].result.meta),console.log(e[0].result.data);const a=e[0].result.data.join("")+"#",i=a.match(/Class Nbr[\s\S]*?(?=Class Nbr|#)/gm),r=a.match(/[A-Z]{3}.*-.*/gm);let n=0;const s=document.getElementById("include-course").checked,o=document.getElementById("include-section").checked,d=document.getElementById("include-component").checked,l=new Y({domain:"uoCal",name:"Test Calendar",timezone:!1}),h=[];for(let t of i){const e=Z(r[n++]);console.log(e,"---------");const a=rt(t);if(a)for(let t of a)for(let a of t.classes){let i=e.code;s&&(i+=" - "+e.name),o&&(i+=" - "+t.section),d&&(i+=" - "+t.componentType.slice(0,3).toUpperCase()),console.log(a),h.push(a.actualStartDate),h.push(a.actualEndDate),h.push(a.startEndDate.end),l.createEvent({start:a.actualStartDate,end:a.actualEndDate,summary:i,description:`Taught by ${a.instructor}`,location:a.location.building+" "+a.location.room,repeating:{freq:"WEEKLY",interval:1,until:a.startEndDate.end}})}}const u=l.toString();let c=u.split("\n");console.log(u);let m=0;for(let t=0;t<c.length;t++){const e=/(DTSTART:)(.*)/,a=/(DTEND:)(.*)/,i=/(UNTIL=)(\d{8}T\d{6}Z?)/;let r=c[t];e.test(r)?(c[t]=r.replace(e,`$1${at(h[m])}\r`),m++):a.test(r)?(c[t]=r.replace(a,`$1${at(h[m])}\r`),m++):i.test(r)&&(c[t]=r.replace(i,`$1${at(h[m])}\r`),m++)}console.log(c);const p=new Blob([c.join("\n")],{type:"text/calendar"}),g=URL.createObjectURL(p),f=document.createElement("a");f.href=g;const y=document.getElementById("file-name");f.download=y.value,document.body.appendChild(f),f.click(),document.body.removeChild(f),URL.revokeObjectURL(g)}))})()})();